<!DOCTYPE html>
<html>
<!-- Copyright (c) 2015 Vladimir Nikitenko - Code Project Open License (CPOL) -->
<head>
  <script src="jsonObjToHtmlTable.js"></script>
  <style>
    #PageHeadText {
      font-size: 1.25em;
      font-weight: bold;
      text-align: center;
    }
    #InParCtrlTbl, #InParCtrlTbl th, #InParCtrlTbl td {
      border : 1px solid black;
      border-collapse : collapse;
    }
    #InParCtrlTbl th, #InParCtrlTbl td {
      text-align : left;
      padding-left: 5px;
      padding-right: 5px;
    }
    #InputDiv {
      width: 630px;
      float: left;
    }
    #OutputDiv {
      margin-left: 632px;
      background-color: LightGray;
      overflow: auto;
    }
    .FuncCallFormat pre, #ActualFuncCallFormat {
      font-family: "Courier New", Monospace;
      font-size: 0.75em;
      font-weight: bold;
      color: Brown;
      line-height: 60%;
    }
    #ActualFuncCallFormat {
      line-height: 120%;
      color: DarkGreen;
    }
    .SpacerDiv {
      height: 10px;
    }
    #AuthorInfo {
      font-size: 0.5325em;
      font-style: italic;
    }
    
    /*****Style of output tables (existing and newly created)*****/
    .OutputTbl,.OutputTbl th,.OutputTbl td   {
      border:1px solid black;
    }
    .OutputTbl thead {
      background-color: Pink;
    }
    /*Color of first tbody */
    .OutputTbl thead + tbody,
    .OutputTbl > tbody:first-child {
      background-color: Beige;
    }
    /*Color of second tbody */
    .OutputTbl thead + tbody + tbody,
    .OutputTbl > tbody:first-child + tbody {
      background-color: LightCyan;
    }
    .OutputTbl tfoot   {
      background-color: Yellow;
    }
    /*Just for fun*/
    .OutputTbl tr:hover {
      background-color: CadetBlue;
    }
      
  </style>
</head>
<body>
  <div id="PageHeadText">
  JSON object to HTML table
  <br>(test application)
  </div>
  <div id="InputDiv">
  Function "full" call format (all params are optional except very first one):
  <div class="FuncCallFormat"><pre>
jsonObjToHtmlTable(aJSObject, aAddHead, aTable, aClearSectionToFill, aSectionToFill,<br>
                   aClearEntireTable, aClearHead, aClearAllBodies, aClearFoot);</pre>
  </div>
  <div id="InParCtrl">
  Function's input parameters control:
  <table id="InParCtrlTbl">
     <thead>
      <tr>
        <th>Parameter</th>
        <th>Pass to<br>function</th>
        <th>Pass Value</th>
      </tr>
    </thead>
    <tbody>
    <tr>
      <td>aAddHead</td>
      <td><input type="checkbox" id="1"></td>
      <td><input type="radio" name="aAddHeadValue" value="">null
          <input type="radio" name="aAddHeadValue" value="0" checked>false
          <input type="radio" name="aAddHeadValue" value="1">true</td>
    </tr>
    <tr>
      <td>aTable</td>
      <td><input type="checkbox" id="2"></td>
      <td><input type="radio" name="aTableValue" value="">null
          <input type="radio" name="aTableValue" value="1" checked>Existing table (at right)</td>
    </tr>
    <tr>
      <td>aClearSectionToFill</td>
      <td><input type="checkbox" id="3"></td>
      <td><input type="radio" name="aClearSectionToFillValue" value="">null
          <input type="radio" name="aClearSectionToFillValue" value="0" checked>false
          <input type="radio" name="aClearSectionToFillValue" value="1">true</td>
    </tr>
    <tr>
      <td>aSectionToFill</td>
      <td><input type="checkbox" id="4"></td>
      <td><input type="radio" name="aSectionToFillValue" value="">null<br>
          <input type="radio" name="aSectionToFillValue" value="h">Existing table head
          <input type="radio" name="aSectionToFillValue" value="b0" checked>Existing table body0<br>
          <input type="radio" name="aSectionToFillValue" value="f">Existing table foot
          <input type="radio" name="aSectionToFillValue" value="b1">Existing table body1</td>
    </tr>
    <tr>
      <td>aClearEntireTable</td>
      <td><input type="checkbox" id="5"></td>
      <td><input type="radio" name="aClearEntireTableValue" value="">null
          <input type="radio" name="aClearEntireTableValue" value="0" checked>false
          <input type="radio" name="aClearEntireTableValue" value="1">true</td>
    </tr>
    <tr>
      <td>aClearHead</td>
      <td><input type="checkbox" id="6"></td>
      <td><input type="radio" name="aClearHeadValue" value="">null
          <input type="radio" name="aClearHeadValue" value="0" checked>false
          <input type="radio" name="aClearHeadValue" value="1">true</td>
    </tr>
    <tr>
      <td>aClearAllBodies</td>
      <td><input type="checkbox" id="7"></td>
      <td><input type="radio" name="aClearAllBodiesValue" value="">null
          <input type="radio" name="aClearAllBodiesValue" value="0" checked>false
          <input type="radio" name="aClearAllBodiesValue" value="1">true</td>
    </tr>
    <tr>
      <td>aClearFoot</td>
      <td><input type="checkbox" id="8"></td>
      <td><input type="radio" name="aClearFootValue" value="">null
          <input type="radio" name="aClearFootValue" value="0" checked>false
          <input type="radio" name="aClearFootValue" value="1">true</td>
    </tr>
    </tbody>
  </table>
  <br><u>Actual</u> function call format:
  <div class="FuncCallFormat">
    <pre id="ActualFuncCallFormat"></pre>
  </div>
  </div>
  
  <div id="InJSON">
  JSON object1 (editable):
  <textarea id="JSObjStr" cols=75 rows=6> </textarea>
  <br><button onclick="fillWithStrObj1()">Fill with above string JSON</button>
      <button onclick="fillWithParsedObj1()">Fill with above parsed JSON</button>
      <button onclick="restoreStrObj1()">Restore original</button>
  <br><br>JSON object2 (editable):
  <br><textarea id="JSArrStr" cols=75 rows=6> </textarea>
  <br><button onclick="fillWithStrObj2()">Fill with above string JSON</button>
      <button onclick="fillWithParsedObj2()">Fill with above parsed JSON</button>
      <button onclick="restoreStrObj2()">Restore original</button>
  </div>
  <div id="AuthorInfo">
  Created by Vladimir Nikitenko
  </div>
  </div>

  <div id="OutputDiv">
  <h3>Output tables</h3>
  <div id="ExistingTblArea">
  Existing table (with two-row tHead, two tBody, tFoot):
  <br><button onclick="restoreExistingTbl()">Restore original</button>
  <div id="ExistingTableContainer">
  <table id="ExistingTable" class="OutputTbl">
     <thead>
      <tr class="headRow">
        <th>head00</th>
        <th>head01</th>
      </tr>
      <tr class="headRow">
        <th>head10</th>
        <th>head11</th>
      </tr>
    </thead>
    <tbody>
    <tr>
      <td>cell00 - body0</td>
      <td>cell01 - body0</td>
    </tr>
    </tbody>
    <tbody>
    <tr>
      <td>cell10 - body1</td>
      <td>cell11 - body1</td>
    </tr>
    </tbody>
    <tfoot>
      <tr class="footRow">
        <th>foot00</th>
        <th>foot01</th>
      </tr>
    </tfoot>
  </table>
  </div>
  </div>
  <br>Newly created tables (same color scheme as above):
  <br><button onclick="clearNewTblsArea()">Delete All</button>
  <div id="NewTblsArea">
  </div>
  </div>

<script>
  var FUNC_CALL_FORMAT = [
    "jsonObjToHtmlTable(aJSObject, aAddHead, aTable, aClearSectionToFill, aSectionToFill,\n                   aClearEntireTable, aClearHead, aClearAllBodies, aClearFoot);",
    "jsonObjToHtmlTable(aJSObject);",
    "jsonObjToHtmlTable(aJSObject, aAddHead);",
    "jsonObjToHtmlTable(aJSObject, aAddHead, aTable);",
    "jsonObjToHtmlTable(aJSObject, aAddHead, aTable, aClearSectionToFill);",
    "jsonObjToHtmlTable(aJSObject, aAddHead, aTable, aClearSectionToFill, aSectionToFill);",
    "jsonObjToHtmlTable(aJSObject, aAddHead, aTable, aClearSectionToFill, aSectionToFill,\n                   aClearEntireTable);",
    "jsonObjToHtmlTable(aJSObject, aAddHead, aTable, aClearSectionToFill, aSectionToFill,\n                   aClearEntireTable, aClearHead);",
    "jsonObjToHtmlTable(aJSObject, aAddHead, aTable, aClearSectionToFill, aSectionToFill,\n                   aClearEntireTable, aClearHead, aClearAllBodies);"
  ];

  var OBJ_STR_SAMPLE = '{"arr": [{ "Col1": "ObjV11", "Col2": "ObjV12", "Col3": "ObjV13" },\n' +
                       '         { "Col1": "ObjV21", "Col2": "ObjV22", "Col3": "ObjV23" },\n' +
                       '         { "Col1": "ObjV31", "Col2": "ObjV32", "Col3": "ObjV33" },\n' +
                       '         { "Col1": "ObjV41", "Col2": "ObjV42", "Col3": "ObjV43" }\n' +
                       '        ]\n' +
                       '}';
  var ARR_STR_SAMPLE = '[{ "field1": "ArrValue11", "field2": "ArrValue12" },\n' +
                       ' { "field1": "ArrValue21", "field2": "ArrValue22" },\n' +
                       ' { "field1": "ArrValue31", "field2": "ArrValue32" }\n' +
                       ']';

  var AJSOBJECT;
  var AADDHEAD, ATABLE, ACLEARSECTIONTOFILL, ASECTIONTOFILL, ACLEARENTIRETABLE, ACLEARHEAD, ACLEARALLBODIES, ACLEARFOOT;
  var FUNC_CALL_INDX;
  var CHBXS = [];

  CHBXS[0] = null;
  for (var i = 1; i <= 8; i++) {
    CHBXS[i] = document.getElementById(String(i));
    CHBXS[i].onclick = function () { if (this.checked)
                                       setPassedParams(null);
                                     else
                                       setPassedParams(Number(this.id));
                                   };
  }
  var JS_OBJ_HTMLELEMENT = document.getElementById("JSObjStr");
  var JS_ARR_HTMLELEMENT = document.getElementById("JSArrStr");
  restoreStrObj1(); //initialization
  restoreStrObj2(); //initialization

  var EXISTINGTABLE = document.getElementById("ExistingTable");
  var EXISTINGTABLE_CONTAINER = document.getElementById("ExistingTableContainer");
  var EXISTINGTABLE_CONTAINER_CONTENT = EXISTINGTABLE_CONTAINER.innerHTML;

  setPassedParams(); //initialization
  
  function setPassedParams(aFirstNotPassedParIndx) {
    var lFirstNotPassedParIndx = Boolean(aFirstNotPassedParIndx) && (aFirstNotPassedParIndx > 0) ? aFirstNotPassedParIndx : CHBXS.length;
    FUNC_CALL_INDX = (lFirstNotPassedParIndx == CHBXS.length) ? 0 : lFirstNotPassedParIndx;
    for (var i = 1; i < CHBXS.length; i++) {
      CHBXS[i].disabled = (i > lFirstNotPassedParIndx);
      CHBXS[i].checked = (i < lFirstNotPassedParIndx);
    }
    var lActualFuncCallFormat = document.getElementById("ActualFuncCallFormat");
    var lTextNode = lActualFuncCallFormat.firstChild; //originally ActualFuncCallFormat is empty
    if (!lTextNode) {
      lTextNode = document.createTextNode("");
      lActualFuncCallFormat.appendChild(lTextNode);
    }
    lTextNode.nodeValue = FUNC_CALL_FORMAT[FUNC_CALL_INDX];
  }

  function getOptionalParamValues() {
    AADDHEAD = getBoolRadioGroupValueByName("aAddHeadValue");
    ATABLE = (getRadioGroupValueByName("aTableValue") == "") ? null : EXISTINGTABLE;
    ACLEARSECTIONTOFILL = getBoolRadioGroupValueByName("aClearSectionToFillValue");

    ASECTIONTOFILL = getRadioGroupValueByName("aSectionToFillValue");
    if (ASECTIONTOFILL == "")
      ASECTIONTOFILL = null;
    else if (ASECTIONTOFILL == "h")
      ASECTIONTOFILL = EXISTINGTABLE.tHead;
    else if (ASECTIONTOFILL == "b0")
      ASECTIONTOFILL = EXISTINGTABLE.tBodies[0];
    else if (ASECTIONTOFILL == "b1")
      ASECTIONTOFILL = EXISTINGTABLE.tBodies[1];
    else
      ASECTIONTOFILL = EXISTINGTABLE.tFoot;

    ACLEARENTIRETABLE = getBoolRadioGroupValueByName("aClearEntireTableValue");
    ACLEARHEAD = getBoolRadioGroupValueByName("aClearHeadValue");
    ACLEARALLBODIES = getBoolRadioGroupValueByName("aClearAllBodiesValue");
    ACLEARFOOT = getBoolRadioGroupValueByName("aClearFootValue");
  }

  function getRadioGroupValueByName(aRadioGroupName) {
    var radioGroup = document.getElementsByName(aRadioGroupName);
    result = "";
    for (var i=0; i < radioGroup.length; i++) {
      if (radioGroup[i].checked) {
        result = radioGroup[i].value;
        break;
      }
    }
    return result;
  }

  function getBoolRadioGroupValueByName(aRadioGroupName) {
    var strValue = getRadioGroupValueByName(aRadioGroupName);
    return (strValue == "") ? null : Boolean(Number(strValue));
  }

  function fillWithStrObj1() {
    AJSOBJECT = JS_OBJ_HTMLELEMENT.value;
    doIt();
  }
  
  function fillWithParsedObj1() {
    AJSOBJECT = JSON.parse(JS_OBJ_HTMLELEMENT.value);
    doIt();
  }

  function fillWithStrObj2() {
    AJSOBJECT = JS_ARR_HTMLELEMENT.value;
    doIt();
  }

  function fillWithParsedObj2() {
    AJSOBJECT = JSON.parse(JS_ARR_HTMLELEMENT.value);
    doIt();
  }

  function doIt() {
    var lTable, lNewTblsArea, lSpacer;
    getOptionalParamValues();

    try {
      lTable = callFillFunc();
      lNewTblsArea = document.getElementById("NewTblsArea"); 

      if (lTable != EXISTINGTABLE) { // newly created table?
        lSpacer = document.createElement("div");
        lSpacer.className = "SpacerDiv";
        lNewTblsArea.appendChild(lSpacer);
        lNewTblsArea.appendChild(lTable);
      }
      lTable.className = "OutputTbl"; //let CSS do work on it
    }
    catch(err) {
      alert(err);
    }
  }

  function callFillFunc() {
    var resultTbl;
    if (FUNC_CALL_INDX == 0)
      resultTbl = jsonObjToHtmlTable(AJSOBJECT, AADDHEAD, ATABLE, ACLEARSECTIONTOFILL, ASECTIONTOFILL,
                                     ACLEARENTIRETABLE, ACLEARHEAD, ACLEARALLBODIES, ACLEARFOOT);
    else if (FUNC_CALL_INDX == 1)
      resultTbl = jsonObjToHtmlTable(AJSOBJECT);
    else if (FUNC_CALL_INDX == 2)
      resultTbl = jsonObjToHtmlTable(AJSOBJECT, AADDHEAD);
    else if (FUNC_CALL_INDX == 3)
      resultTbl = jsonObjToHtmlTable(AJSOBJECT, AADDHEAD, ATABLE);
    else if (FUNC_CALL_INDX == 4)
      resultTbl = jsonObjToHtmlTable(AJSOBJECT, AADDHEAD, ATABLE, ACLEARSECTIONTOFILL);
    else if (FUNC_CALL_INDX == 5)
      resultTbl = jsonObjToHtmlTable(AJSOBJECT, AADDHEAD, ATABLE, ACLEARSECTIONTOFILL, ASECTIONTOFILL);
    else if (FUNC_CALL_INDX == 6)
      resultTbl = jsonObjToHtmlTable(AJSOBJECT, AADDHEAD, ATABLE, ACLEARSECTIONTOFILL, ASECTIONTOFILL,
                                     ACLEARENTIRETABLE);
    else if (FUNC_CALL_INDX == 7)
      resultTbl = jsonObjToHtmlTable(AJSOBJECT, AADDHEAD, ATABLE, ACLEARSECTIONTOFILL, ASECTIONTOFILL,
                                     ACLEARENTIRETABLE, ACLEARHEAD);
    else
      resultTbl = jsonObjToHtmlTable(AJSOBJECT, AADDHEAD, ATABLE, ACLEARSECTIONTOFILL, ASECTIONTOFILL,
                                     ACLEARENTIRETABLE, ACLEARHEAD, ACLEARALLBODIES);
    return resultTbl;
  }

  function restoreStrObj1() {
    JS_OBJ_HTMLELEMENT.value = OBJ_STR_SAMPLE;
  }
  function restoreStrObj2() {
    JS_ARR_HTMLELEMENT.value = ARR_STR_SAMPLE;
  }

  function restoreExistingTbl() {
    //EXISTINGTABLE.innerHTML = existingTblOriginalContent; //Restoring just content of table does not work in IE (at least in IE8)
    EXISTINGTABLE_CONTAINER.innerHTML = EXISTINGTABLE_CONTAINER_CONTENT;
    EXISTINGTABLE = document.getElementById("ExistingTable"); //Refresh this value since "existing" table was recreated
  }
  function clearNewTblsArea() {
    var newTblsParent = document.getElementById("NewTblsArea");
    var elementsList = newTblsParent.childNodes;
    for (var i = elementsList.length - 1; i >= 0; i--)
      newTblsParent.removeChild(elementsList[i]);
  }
</script>

</body>
</html>
